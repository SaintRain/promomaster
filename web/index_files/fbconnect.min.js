!function(e,o){function n(e){this.config=e,this.activityQueue=[],this.ssFbConnectReady=!0,this.fbErrorCodes={INVALID_ACCESS_TOKEN:190,REQUIRES_EXTENDED_PERMISSIONS:200},this.linkFbProfileResponse={PROFILE_LINKED:1,NOT_LOGGED_IN:2,USER_ALREADY_EXISTS:3,NO_PUBLISH_PERMISSIONS:4},this.fbReconnectNotification={DAYS_UNTIL_NEXT_NOTICE:3,MAX_NUMBER_OF_DISMISSALS:2},this.basic_perms={scope:"email, publish_actions"},this.download_perms={scope:"email,publish_actions,user_about_me,user_birthday,user_location,user_website,user_work_history"}}function t(e){n.call(this,e),this.fbCallbacks=[]}function i(e){n.call(this,e)}n.prototype.init=function(){this.loadScript()},n.prototype.loadScript=function(){window.fbAsyncInit=o.proxy(function(){FB.init(e.fb_init_params),o(document).trigger("fbinitialized"),this.onFbInitialized(),e.user.loggedin||FB.Event&&FB.Event.subscribe("auth.statusChange",o.proxy(this.onFBStatusChange,this))},this),o("body").append('<div id="fb-root"></div>');var n=document.createElement("script");n.src=document.location.protocol+"//connect.facebook.net/en_US/all.js",n.id="facebook-jssdk",n.async=!0,document.getElementById("fb-root").appendChild(n)},n.prototype.onFbInitialized=function(){o("#fb-login").removeClass("disabled"),window.FB&&e.isSlideViewPage()&&(FB.Event.subscribe("edge.create",function(e){_gaq.push(["_trackSocial","facebook","like",e]),_gaq.push(["_trackEvent","bigfoot_slideview","viralsharefacebook"])}),this.pushPendingFBactivities())},n.prototype.onFBStatusChange=function(o){if(this.disable_autologin!==!0){var n=o.status;"connected"===n&&"true"!==cookie("autologin_disabled")&&(e.ga("fb_opengraph","auto_login","connected"),this.fbAutoLogin(o.authResponse.accessToken,o.authResponse.userID))}},n.prototype.fbAutoLogin=function(o,n){this.ssFbConnect("/fbconnect/create_account_or_login?from=fb_auto_login",{access_token:o,fb_user_id:n,auto_login:!0},function(o){o.status<4?(e.ga("fb_opengraph","auto_login","login_successful"),e.fbConnect.reloadPage()):e.ga("fb_opengraph","auto_login","login_failed")})},n.prototype.reloadPage=function(){window.location.reload()},n.prototype.allow_publish_for=function(o){return e.user.is_opengraph_user&&e.user.opengraph_permissions[o]&&e.user.has_fb_access_token},n.prototype.og_url_for=function(o){return"follow"===o?"/me/og.follows":"/me/"+e.fb_app_name+":"+o},n.prototype.og_params_for=function(e){var o=e.ppt_url||location_without_params(),n={};switch(e.name){case"view":case"favorite":n.presentation=o;break;case"download":var t=getUrlVar("s_title"),i=getUrlVar("user_login");n.presentation="http://www.slideshare.net/"+i+"/"+t;break;case"comment":n.presentation=o,n.message=e.message;break;case"follow":n.profile=e.facebook_user_id;break;default:error("Unknown action: "+e.name)}return n},n.prototype.og_notify_ga=function(o){var n=getUrlVar("fb_source");getUrlVar("code")||n?n?e.ga("fb_opengraph","publish_action","from_facebook_"+o+"_"+n):e.ga("fb_opengraph","publish_action","from_facebook_"+o):e.ga("fb_opengraph","publish_action",o)},n.prototype.fb_reconnect_callback=function(e){e===this.linkFbProfileResponse.USER_ALREADY_EXISTS?o("#page-error").append("This Facebook login is already being used with another SlideShare account. Try again using another account.").show():window.location.reload()},n.prototype.fbconnect_delink_callback=function(){window.location.reload()},n.prototype.fbconnect_login_redirect_from_iframe=function(n,t){var i=o("#target_url").val(),a="fbconnectDefault";switch(n.status){case 1:e.ga("Signup","fb_login","fb_signup_from_"+t),a="fbconnectNewUser";break;case 2:a="fbconnectExistingUser";break;case 3:e.ga("Login","fb_login","fb_login_from_"+t),a="fbconnectExistingUserWithLinkedAccount";break;case 4:a="fbconnectFailed";break;case 5:a="fbconnectSuspendedUser"}o.postMessage(a,i,parent)},n.prototype.fbconnect_login_redirect_link=function(e){switch(o("#j-fb-topnav-indicator").hide(),o("#j-fb-login-indicator").hide(),e.status){case this.linkFbProfileResponse.PROFILE_LINKED:window.location.reload();break;case this.linkFbProfileResponse.USER_ALREADY_EXISTS:o("#page-error").append("We could not connect your SlideShare account to Facebook. This Facebook login is already being used with another SlideShare account.").show();break;case this.linkFbProfileResponse.NO_PUBLISH_PERMISSIONS:o("#page-error").append("We could not connect your SlideShare account to Facebook. Sharing on SlideShare is better when you allow us to post to Facebook.").show(),o("#fb-login")&&o("#fb-login").html("<strong>Connect</strong>").removeClass("disabled");break;default:o("#page-error").append("There was an error.").show()}},n.prototype.fbconnect_login_redirect=function(n,t){var i=escape(window.location.href),a=window.fromSource,s=window.fromType||getUrlVar("from");switch(!window.location.pathname.startsWith("/upload")||1!==n.status&&2!==n.status&&3!==n.status||(e.ga("Upload","fb_login_successful"),i=i.replace("loggedout_","loggedin_loggedout_")),n.status){case 1:e.ga("Signup","fb_login","fb_signup_from_"+t),window.location.replace("undefined"!=typeof a?"/fbconnect/landingpage?from="+a:"/fbconnect/landingpage?from="+i);break;case 2:window.location.replace("undefined"!=typeof a?"/fbconnect/landingpage?from="+a:"/fbconnect/landingpage?from="+i);break;case 3:e.ga("Login","fb_login","fb_login_from_"+t);var r=decodeURIComponent(a);if(void 0!==getUrlVars().from_logout&&"undefined"==typeof s)window.location.replace("/");else{if(window.location.pathname.startsWith("/upload"))return window.location.replace(window.location.href.replace("loggedout_","loggedin_loggedout_")),!1;a&&a.length>1&&isInternalRedirect(a)&&window.location.href!==r?window.location.href=r:window.location.reload()}break;case 4:o(".j-alert").html("Login unsuccessful. Please try again."),o(".j-alert").removeClass("hide");break;case 5:o(".j-alert").html("Login unsuccessful. Your account has been suspended as it was found to be in violation of SlideShare's Terms of Service and/or Community Guidelines. Please read the <a href='http://help.slideshare.com/entries/22330620-Why-was-my-slideshare-account-suspended-' target='_blank' class='blue_link_bold'>Suspended Users FAQ</a> to resolve this issue."),o(".j-alert").removeClass("hide");break;default:window.location.reload()}},n.prototype.hidefbErrorNotification=function(){if(!window.localStorage)return!0;try{var e="fbErrorDismissals",o=Number(window.localStorage[e])||0;if(0===o)return!1;if(o>=this.fbReconnectNotification.MAX_NUMBER_OF_DISMISSALS)return!0;var n=window.localStorage.fbErrorLastDismissal||(new Date).getTime(),t=(new Date).getTime(),i=Math.ceil((t-n)/864e5);return i<=this.fbReconnectNotification.DAYS_UNTIL_NEXT_NOTICE}catch(a){return!0}},n.prototype.rememberFbErrorDismissal=function(){if(window.localStorage)try{var e="fbErrorDismissals",o=Number(window.localStorage[e])||0;window.localStorage[e]=String(o+1),window.localStorage.fbErrorLastDismissal=(new Date).getTime()}catch(n){}},n.prototype.modalLoginFbButtonClickCallback=function(n){window.fromSource=window.fromSource||getUrlVar("from_source");var t="fancybox";o("#j-fb-modalbox-indicator").show();var i=e.fbConnect.basic_perms;e.isDownloadUrl()&&(i=e.fbConnect.download_perms),e.fbConnect.unsubscribeFBStatusChange(),window.FB&&FB.login(function(i){i&&i.authResponse&&e.fbConnect.ssFbConnect("/fbconnect/create_account_or_login"+(e.isDownloadUrl()?"?from_page=download":""),{access_token:i.authResponse.accessToken,fb_user_id:i.authResponse.userID,login_source:window.loginSource},function(e){"undefined"!=typeof n&&n(e,t)}),o("#j-fb-modalbox-indicator").hide()},i)},n.prototype.reconnectToFb=function(){if(e.user.loggedin&&e.user.is_opengraph_user&&!e.user.has_fb_access_token){var n=e.fbConnect.download_perms;n.return_scopes=!0,e.fbConnect.unsubscribeFBStatusChange(),window.FB&&FB.login(function(n){n&&n.authResponse&&o.post("/fbconnect/link_facebook_profile",{access_token:n.authResponse.accessToken,fb_user_id:n.authResponse.userID,granted_perms:n.authResponse.grantedScopes},function(o){e.fbConnect.fb_reconnect_callback(o.status)},"json")},n),e.ga("fb_opengraph","reconnect-notice","connected")}},n.prototype.bindEvents=function(){if(e.user.loggedin||o("body").on("click","#fb-login-modalbox, #fblogin-modal-cta",function(){e.fbConnect.modalLoginFbButtonClickCallback(o.proxy(e.fbConnect.fbconnect_login_redirect_from_iframe,e.fbConnect))}),o("#j-delink-fb").on("click",function(n){n.preventDefault(),o.post("/fbconnect/delink_facebook_profile",{},e.fbConnect.fbconnect_delink_callback,"json")}),(e.isHomePage()||e.isSlideViewPage())&&!e.is_mobile&&e.user&&e.user.is_opengraph_user&&!e.user.has_fb_access_token&&!this.hidefbErrorNotification()){var n="Your facebook connection has expired. <a href='#' id='fb-reconnect'>Click here to connect and continue sharing.</a>",t=o("#flash-notice");t.find("span").html(n),t.slideDown("slow"),e.ga("fb_opengraph","reconnect-notice","displayed"),t.find(".close").click(function(){this.rememberFbErrorDismissal(),e.ga("fb_opengraph","reconnect-notice","cancelled")})}o("#fb-reconnect").click(o.proxy(function(e){e.preventDefault(),this.reconnectToFb()},this)),o("#fb-login").click(function(n){if(!o(this).hasClass("disabled")){var t="login";n.preventDefault(),window.fromSource=getUrlVar("from_source")||encodeURIComponent("/"),o("#j-fb-login-indicator").show(),o(this).hasClass("fb-login-new")||o(this).html("Connecting...").addClass("disabled");var i=e.fbConnect.basic_perms;e.user.loggedin&&(i=e.fbConnect.download_perms),i.return_scopes=!0,e.fbConnect.unsubscribeFBStatusChange(),window.FB&&FB.login(function(n){n&&n.authResponse?e.user.loggedin?e.user.is_fbuser&&e.user.is_opengraph_user&&e.user.has_fb_access_token||o.post("/fbconnect/link_facebook_profile",{access_token:n.authResponse.accessToken,fb_user_id:n.authResponse.userID,granted_perms:n.authResponse.grantedScopes},function(o){e.fbConnect.fbconnect_login_redirect_link(o)},"json"):o.post("/fbconnect/fb_login",{},function(){e.fbConnect.ssFbConnect("/fbconnect/create_account_or_login",{access_token:n.authResponse.accessToken,fb_user_id:n.authResponse.userID,login_source:window.loginSource,granted_perms:n.authResponse.grantedScopes},function(o){e.fbConnect.fbconnect_login_redirect(o,t)})},"json"):o("#j-fb-login-indicator").hide()},i)}})},n.prototype.post_activity_to_facebook=function(e,o){return this.allow_publish_for(e.name)||"undefined"==typeof o?this.shouldQueueActivity()?void this.activityQueue.push({action:e,callback:o}):void this.push_activity_to_facebook(e,o):void o()},n.prototype.shouldQueueActivity=function(){return void 0===window.FB},n.prototype.push_activity_to_facebook=function(e,o){var n=this.og_url_for(e.name),t=this.og_params_for(e);this.fbApiPost(n,t,o),this.og_notify_ga(e.name)},n.prototype.fbApiPost=function(n,t,i){FB.api(n,"post",t,o.proxy(function(n){n&&n.error&&(n.error.code===this.fbErrorCodes.REQUIRES_EXTENDED_PERMISSIONS?o.post("/fbconnect/remove_publish_perms"):n.error.code===this.fbErrorCodes.INVALID_ACCESS_TOKEN&&o.post("/fbconnect/invalidate_access_token"),e.ga("fb_opengraph_error",n.error.type+"-"+n.error.code,n.error.message,e.user.id)),"undefined"!=typeof i&&i(n)},this))},n.prototype.pushPendingFBactivities=function(){for(var e=this.activityQueue;e.length;){var o=e.pop();this.push_activity_to_facebook(o.action,o.callback)}},n.prototype.mergeUsers=function(e,n){o.post("/fbconnect/merge_users",{user_login:e.user_login,user_password:e.user_password},n)},n.prototype.ssFbConnect=function(e,n,t){this.ssFbConnectReady===!0&&(this.ssFbConnectReady=!1,o.post(e,n,function(e){this.ssFbConnectReady=!0,t(e)},"json"))},n.prototype.unsubscribeFBStatusChange=function(){this.disable_autologin=!0},n.prototype.setup_opengraph_interaction=function(){o(".player").bind("fb-favorite-failed",function(o,n){e.ga("fb_opengraph","favorite-publish-failed",n.id||n.type,n.message)})},t.prototype=new n,t.prototype.init=function(){e.registerMessageReceiver(o.proxy(this.messageReceiver,this)),o("body").append('<iframe id="'+this.config.fbApiIframeId+'" style="display:none"></iframe>');var n=o("#"+this.config.fbApiIframeId);n.length>0&&(n.attr("src",this.config.fbApiIframeUrl),this.fbApiIframeWindow=window.frames[this.config.fbApiIframeId].contentWindow)},t.prototype.messageReceiver=function(e){if("fbinitialized"==e)o(document).trigger("fbinitialized"),this.onFbInitialized();else if("reloadPage"==e)this.reloadPage();else if(e.startsWith("fbReconnect:")){var n=e.substr("fbReconnect:".length);this.fb_reconnect_callback(n)}},t.prototype.postMessageToFbApiIframe=function(e){o.postMessage(e,this.config.fbApiIframeUrl,this.fbApiIframeWindow)},t.prototype.shouldQueueActivity=function(){return!1},t.prototype.reconnectToFb=function(){this.postMessageToFbApiIframe("fbReconnect")},i.prototype=new n,i.prototype.init=function(){e.registerMessageReceiver(o.proxy(this.messageReceiver,this)),this.loadScript()},i.prototype.onFbInitialized=function(){this.postMessage("fbinitialized")},i.prototype.postMessage=function(e){var n=o("#target_url").val();o.postMessage(e,n,parent)},i.prototype.messageReceiver=function(e){"fbReconnect"==e&&this.reconnectToFb()},i.prototype.reloadPage=function(){this.postMessage("reloadPage")},n.prototype.fb_reconnect_callback=function(e){this.postMessage("fbReconnect:"+e)},e.setup_fbconnect_interaction=function(){e.fbConnect.bindEvents()},e.setup_opengraph_interaction=function(){e.fbConnect.setup_opengraph_interaction()},e.post_activity_to_facebook=function(o,n){e.fbConnect.post_activity_to_facebook(o,n)},e.fbConnect=e.fb_api_iframe===!0?new i:e.user.loggedin||e.is_ssl?new n:new t({fbApiIframeId:"fb-api-iframe",fbApiIframeUrl:"https://"+o(location).attr("hostname")+"/fbconnect/fb_api_iframe"}),o(window).load(function(){e.fbConnect.init()})}(slideshare_object,jQuery);