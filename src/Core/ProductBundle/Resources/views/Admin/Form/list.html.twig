{% extends 'ApplicationSonataAdminBundle:CRUD:list_top.html.twig' %}

{#Добавляем кнопку Импортировать прайс#}
{% block actions %}
<div id="import-csv-format-description" style="display:none;">{{ ServiceContainer.get('core_config_logic').get('import-csv-format-description')|raw}}
    <div style="vertical-align:baseline;" class="well well-small form-actions"><a class="btn btn-danger import-csv-format-descriptionClose" href="JavaScript:void(0);">Закрыть</a></div>
</div>
    <div id="productParceDialogContent" style="display:none">
        <form id="productPriceFormUpload" enctype="multipart/form-data">
            <p>Допускается загрузка файлов в формате .csv</p>
            <a class="btn btn-large productProceUploadButton" title="Загрузить"><span class="icon-trash icon-upload"></span> Загрузить файл</a>
            <input name="productPrice" type="file" accept=".csv" style="display: none"/>
            <input type="button" class="btn btn-primary" style="display: none" value="Загрузить" />
            &nbsp;&nbsp;<a class="import-csv-format-description" href="JavaScript:void(0);">Описание формата CSV</a>
        </form>

        <div id="productPriceFormUploadProgress" class="progress progress-info progress-file progress-striped active" style="visibility: hidden;">
            <div class="bar" style="width: 0%;">
                <span>0%</span>
            </div>
        </div>
        <div class="alert alert-success alert-dismissable" id="productPriceFormUploadProgressOk" style="display:none"></div>
        <div class="alert alert-error alert-dismissable" id="productPriceFormUploadProgressError" style="display:none"></div>

        <div style="vertical-align:baseline;" class="well well-small form-actions"><a class="btn btn-danger productParceDialogContentClose" href="JavaScript:void(0);">Закрыть</a></div>
    </div>

    <div id="ymlDialogContent" style="display:none">
            Будут сгерерированы файлы:<br/>
            <a href="http://{{domain_ru}}/yml_wt.xml">http://{{domain_ru}}/yml_wt.xml</a><br/>
            <a href="http://{{domain_ru}}/yml_market.xml">http://{{domain_ru}}/yml_market.xml</a>
        </p>

        <div id="ymlProgress" class="progress progress-info progress-file progress-striped active" style="visibility: hidden;">
            <div class="bar" style="width: 0%;">
                <span>0%</span>
            </div>
        </div>

        <div class="alert alert-success alert-dismissable" id="ymlProgressOk" style="display:none"></div>
        <div class="alert alert-error alert-dismissable" id="ymlProgressError" style="display:none"></div>

        <div style="vertical-align:baseline;" class="well well-small form-actions"><input type="button" class="btn btn-primary ymlGenerateButton"  value="Сгенерировать YML-файл" /> &nbsp;<a class="btn btn-danger ymlDialogContentClose" href="JavaScript:void(0);">Закрыть</a></div>
    </div>
    <script>
        var intervalProductParceId,
                intervalYmlGenerateId,
                core_product_yml_generator_start = '{{path('core_product_yml_generator_start')}}',
                core_product_yml_generator_check_status = '{{path('core_product_yml_generator_check_status')}}',
                core_product_upload_price_file = '{{path('core_product_upload_price_file')}}',
                core_product_upload_check_status = '{{path('core_product_upload_check_status')}}';

    </script>
    <script src="{{ asset('bundles/coreproduct/Admin/js/importPrice.js')}}" type="text/javascript"></script>
    <script src="{{ asset('bundles/coreproduct/Admin/js/ymlGenerate.js')}}" type="text/javascript"></script>
<script>
     var product_dublicate_create="{{path('product_dublicate_create')}}";
    </script>
    <script src="{{ asset('bundles/coreproduct/Admin/js/dublicate.js')}}" type="text/javascript"></script>
    <div class="sonata-actions btn-group">
        <span class="btn-group sonata-action-element">
            <a style="margin-top:0px" class="btn sonata-action-element ymlButton" href="JavaScript:void(0);"><i class="icon-download"></i> Сген. YML <span style="line-height:0px;font-size: 12px;color: gray;">{{filemtime('yml_wt.xml')}}</span></a>
            <a style="margin-top:0px" class="btn sonata-action-element productPriceButton" href="JavaScript:void(0);"><i class="icon-download"></i> Импорт прайсa</a>
        </span>
    </div>

    {{parent()}}
    
{% endblock %}