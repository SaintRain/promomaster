{% block  extra_status_widget %}
       <input  type="hidden" {{ block('widget_attributes') }} value="{%if value.id is defined%}{{value.id}}{%else%}{{value}}{%endif%}">
    <script>

            $(document).ready(function() {
                var uniqId = "{{sonata_admin.admin.uniqId}}";


                showHideExtraStatusOptions();


                $('#' + uniqId + '_isCanceledStatus').click(function() {
                 showHideExtraStatusOptions();
                });

                $('#' + uniqId + '_isShippedStatus').click(function() {
                 showHideExtraStatusOptions();
                });

                $('#' + uniqId + '_isPaidStatus').click(function() {
                 showHideExtraStatusOptions();
                });

                $('#' + uniqId + '_isCheckedStatus').click(function() {
                 showHideExtraStatusOptions();
                });


            function showHideExtraStatusOptions() {
                var
                    extraStatuses={
                        {%for d in options.extraStatusesData%}
                                {{d.id}}: {
                                    id:{{d.id}},
                                    captionRu:'{{d.captionRu|e('js')}}',
                                    generalStatus:'{{d.generalStatus}}'
                                },
                        {%endfor%}
                    };

                //определяем последний статус
                if ($('#' + uniqId + '_isCanceledStatus').attr("checked")) {
                    generalStatus={{constant('Core\\OrderBundle\\Entity\\ExtraStatus::canceledStatusCode')}};
                }
                else
                if ($('#' + uniqId + '_isShippedStatus').attr("checked")) {
                    generalStatus={{constant('Core\\OrderBundle\\Entity\\ExtraStatus::shippedStatusCode')}};
                }
                else if ($('#' + uniqId + '_isPaidStatus').attr("checked")) {
                    generalStatus={{constant('Core\\OrderBundle\\Entity\\ExtraStatus::paidStatusCode')}};
                }
                else
                if ($('#' + uniqId + '_isCheckedStatus').attr("checked")) {
                    generalStatus={{constant('Core\\OrderBundle\\Entity\\ExtraStatus::checkedStatusCode')}};
                }


                //очищаем список
                $('#' + uniqId + '_extraStatus').select2({data:[]});
                if (typeof generalStatus!=='undefined') {
                   //добавляем элементы
                    var newData= [];
                    for (var index in extraStatuses) {
                        if (extraStatuses[index].generalStatus==generalStatus) {
                            newData.push({id:extraStatuses[index].id,text:extraStatuses[index].captionRu});
                        }
                    }
                    $('#' + uniqId + '_extraStatus').select2({data:newData});
                }

            };
            });

        </script>
        {% endblock %}